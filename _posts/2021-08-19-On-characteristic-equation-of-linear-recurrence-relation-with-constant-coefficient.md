---
layout: post
---
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <meta name="author" content="Saptarshi Dandapat" />
  <title>On some explanation and intuition behind characteristic equation for finding general term of a linear recurrence relation with constant coefficients</title>
  <style type="text/css">
      code{white-space: pre-wrap;}
      span.smallcaps{font-variant: small-caps;}
      span.underline{text-decoration: underline;}
      div.column{display: inline-block; vertical-align: top; width: 50%;}
  </style>
  <script src="/usr/share/javascript/mathjax/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
</head>
<body>
<header id="title-block-header">
<h1 class="title">On some explanation and intuition behind characteristic equation for finding general term of a linear recurrence relation with constant coefficients</h1>
<p class="author">Saptarshi Dandapat</p>
</header>
<p>To start our study of linear recurrence relations with constant coefficients, we introduce an operator called "left-shift" operator.</p>
<p><span>The left-shift operator</span> Suppose we have a sequence <span class="math inline">\(\{x_n\} = \{x_1,x_2,x_3,\ldots\}\)</span>, then the left-shift operator is given by the rule: <span class="math display">\[L(x_n)=x_{n+1}\]</span>So, the operator <span class="math inline">\(L\)</span> on <span class="math inline">\(\{x_n\}\)</span> yields <span class="math display">\[\{L(x_n)\} = \{Lx_1, Lx_2, Lx_3, \ldots\} = \{x_2,x_3,\ldots\}\]</span>Which is exactly same as the original sequence <span class="math inline">\(\{x_n\}\)</span> shifted one unit towards left.</p>
<p>Firstly, we concentrate our study to one of the most famous recurrence relation, the <em>Fibonacci Sequence</em>: <span class="math inline">\(a_{n+2}=a_{n+1}+a_n\)</span> with <span class="math inline">\(a_1=a_2=1\)</span>. Now introducing <span class="math inline">\(L\)</span> operators, we have <span class="math inline">\(a_{n+1}=L(a_n)\)</span> and <span class="math inline">\(a_{n+2}=L(a_{n+1})=L^2(a_n)\)</span>, So, <span class="math display">\[a_{n+2}-a_{n+1}-a_n=0 \iff L^2(a_n)-L(a_n)-1.a_n=0\]</span>which equivalent to writing as <span class="math display">\[(L^2-L-1)a_n=0.\]</span> Now note the analogy to differential equations where the derivative operator <span class="math inline">\(D\)</span> sends the function <span class="math inline">\(y\)</span> to its derivative <span class="math inline">\(y&#39;\)</span>. For example, the differential equation <span class="math inline">\((D^2+1)y=0\)</span> is same as <span class="math inline">\((D+\iota)(D-\iota)y=0.\)</span> Now, we can solve <span class="math inline">\((D+\iota)y=0\)</span> and <span class="math inline">\((D-\iota)y=0\)</span> separately and then the general solution is the "linear combination" of the two solutions <span class="math inline">\(Ae^{-\iota x}\)</span> and <span class="math inline">\(Be^{\iota x}\)</span>.</p>
<p><span>Why will the same theory will work on left-shift operator</span> The method shown above for solving a differential equation works, because <span class="math inline">\(D\)</span> is a linear operator, i.e., <span class="math inline">\(D(y_1+y_2)=Dy_1+Dy_2\)</span> and <span class="math inline">\(D(cy)=cDy\)</span>. Now, the <span class="math inline">\(L\)</span> operator is also linear, which can be easily verified. So all the theories of linear analysis will hold good for this <span class="math inline">\(L\)</span> operator. i.e., the equation <span class="math inline">\((L^2-L-1)a_n=0\)</span> can be solved by solving the factored version of this equation separately. Now, let <span class="math inline">\(\alpha, \beta\)</span> are two roots of the algebraic equation <span class="math inline">\(m^2-m-1=0\)</span>, let <span class="math display">\[\alpha=\frac{1+\sqrt{5}}{2} \qquad \beta = \frac{1-\sqrt{5}}{2}\]</span>(Note <span class="math inline">\(\alpha\)</span> is the <em>Golden ratio</em>.)</p>
<p>So, to solve the equation <span class="math inline">\((L^2-L-1)a_n=0\)</span> we solve <span class="math inline">\((L-\alpha)a_n=0\)</span> and <span class="math inline">\((L-\beta)a_n=0\)</span> separately and linearly combine the results to get a general solution.</p>
<p><span>Obtaining final solution</span> <span class="math inline">\((L-\beta)b_n=0 \iff L(b_n) = \beta b_n,\)</span> i.e., <span class="math inline">\(b_{n+1}=\beta b_n.\)</span> Again, this equation is just a geometric sequence with the general solution <span class="math display">\[b_n=B\beta^n.\]</span>Where <span class="math inline">\(A\)</span> is some real constant, similarly <span class="math inline">\((L-\alpha)c_n=0 \iff c_n = A\alpha^n.\)</span> Hence the general solution of <span class="math inline">\((L^2-L-1)a_n=0\)</span> is of the form <span class="math display">\[a_n = A\alpha^n + B\beta^n.\]</span></p>
<p><span>The desired formula for Fibonacci Sequence</span> To simplify the algebra, we take <span class="math inline">\(a_0=0\)</span> and <span class="math inline">\(a_1=1\)</span> as initial conditions for fibonacci sequence. So, <span class="math display">\[a_0=0=A\alpha^0 + B\beta^0 \implies A = -B\]</span> <span class="math display">\[a_1=1=A(\alpha-\beta)= A\left(\frac{1+\sqrt{5}}{2}-\frac{1-\sqrt{5}}{2}\right)=A\sqrt{5}\implies A = \frac{1}{\sqrt{5}}.\]</span>Hence we have the general formula, <span class="math display">\[a_n = \frac{1}{\sqrt{5}}\left[\left(\frac{1+\sqrt{5}}{2}\right)^n-\left(\frac{1-\sqrt{5}}{2}\right)^n\right]\]</span></p>
<p><span>Generalisation</span> From the above method, we can see that this method will work on any linear recurrence relation with constant coefficients. For example, the solution to the relation <span class="math inline">\(a_{n+2}-3a_{n+1}+2a_n=0\)</span> can be found in this way. Similarly the problem <span class="math inline">\(a_{n+2}-2a_{n+1}+a_n=0\)</span> will pose the same problem as <span class="math inline">\((D-1)^2y=0\)</span> would in ordinary differential equation theory.</p>
<p>Hence, for a general linear recurrence relation with constant coefficients, comparing the <span class="math inline">\(L\)</span> operator with the usual <span class="math inline">\(D\)</span> operator in ode-theory, we conclude that all results which are true for the solution space of a Linear First Order Differential Equation, is also true for solution of the corresponding linear recurrence relation. We mention some special cases or examples below.</p>
<p>Suppose <span class="math inline">\(a_{n+2}=Aa_{n+1}+Ba_n\)</span>, <span class="math inline">\(A,B \in \mathbb{R}\)</span> is a linear recurrence relation. Using the <span class="math inline">\(L\)</span> operator, we get <span class="math inline">\((L^2-AL-B)a_n=0\)</span> and we call the equation <span class="math inline">\(m^2-Am-B=0\)</span> to be the <em>characteristic equation</em> of the given recurrence relation. So, there are three cases possible.</p>
<ul>
<li><p><strong>Case 1:</strong> The equation has two real roots, <span class="math inline">\(m_1\)</span> and <span class="math inline">\(m_2\)</span>, then <span class="math inline">\(a_n=ax_1^n+bx_2^n, a,b \in \mathbb{R}\)</span>.</p></li>
<li><p><strong>Case 2:</strong> The equation has one root of multiplicity 2, then <span class="math inline">\(a_n = ax_1^n+bnx_1^n\)</span> is the solution. (analogous to that in differential equations)</p></li>
<li><p><strong>Case 3:</strong> The equation has two distinct complex roots : <span class="math inline">\(re^{\iota \theta}, re^{-\iota \theta}\)</span>, then <span class="math inline">\(a_n=r^n(a\cos (n\theta) + b\sin (n\theta))\)</span> is the general solution.</p></li>
</ul>
<p><span>What next...</span> We observed a nice relation and analogy between the left shift operator and the differential operator. Also in the formulae stated in the above section tells us that there is only a little bit of difference from those in the case of differential equations, and that is the use of exponential function. Now we will see, can we establish a theory to explain this event?</p>
<p>Firstly, lets move on to a continuous domain from discretized domain of sequence, i.e., extend the definition of a left shift operator as : <span class="math inline">\(L(f(x))=f(x+1)\)</span>, where <span class="math inline">\(f\)</span> is a real valued smooth function. Therefore, we have <span class="math inline">\(L^h(f(x))=f(x+h)\)</span>. Consider the space of space of real valued functions which are bounded and have continuous derivatives. Then observe that the action of the operator <span class="math inline">\(L^h\)</span> on this space forms a semigroup structure. <span class="math display">\[L^s(L^tf(x))=L^sf(x+t)=f(s+t+x)=L^{s+t}f(x).\]</span>Also we have <span class="math inline">\(L^0f(x)=f(x)\)</span>, so <span class="math inline">\(L^0\)</span> is the identity operator. Now, <span class="math display">\[D(f(x))= \lim\limits_{h \to 0} \frac{1}{h}(L^hf-f).\]</span>Now, from taylor series, <span class="math display">\[f(x)=\sum\limits_{k=0}^{\infty} \frac{1}{k!}D^kf(x) h^k= \sum\limits_{k=0}^{\infty} \left(\frac{(hD)^k}{k!}f\right)(x)\]</span>Again, we have <span class="math display">\[e^{hD}=\sum\limits_{k=0}^{\infty} \frac{(hD)^k}{k!}\]</span>Therefore, <span class="math inline">\(L^hf(x)=e^{hD}f(x)\)</span> and hence, <span class="math inline">\(L=e^D\)</span>.</p>
<p>Hence the left-shift <span class="math inline">\(L\)</span> operator and the differential <span class="math inline">\(D\)</span> operator are related exponentially to each other.</p>
<p><span style="color: blue">Now our target is to find some more cool facts about the <span class="math inline">\(L\)</span> operators.</span></p>
</body>
</html>
